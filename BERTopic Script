{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"mount_file_id":"17_oGEy7ay9p7UJrxTYyk-IApuyD2JE9P","authorship_tag":"ABX9TyNSlbh3XjiLHSrMRfwPJqkP"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"5b895c0b60b043d2b566b15ffff60791":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_af8928f5ca764bbd829df3aa292687af","IPY_MODEL_0ed3901650eb4c138977cecd92d91def","IPY_MODEL_dee67eddeb6442a5969e8ff3247cf451"],"layout":"IPY_MODEL_ff04ebac5df74fd0a3ef7b1713643c1f"}},"af8928f5ca764bbd829df3aa292687af":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b67fbc99f6e747df8b6ad159ac99661b","placeholder":"​","style":"IPY_MODEL_498fdfab08484722ab08cdc4579d78fe","value":"Batches: 100%"}},"0ed3901650eb4c138977cecd92d91def":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2473ce91a553489c80d7fd44c6053bed","max":90,"min":0,"orientation":"horizontal","style":"IPY_MODEL_5a4899d4de6b483bbcfad075590d58a2","value":90}},"dee67eddeb6442a5969e8ff3247cf451":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6878972bcecd47e897ca6c622aa10e3f","placeholder":"​","style":"IPY_MODEL_6c4f705e35df4e1d8eb45848822e2c6e","value":" 90/90 [01:56&lt;00:00,  2.72it/s]"}},"ff04ebac5df74fd0a3ef7b1713643c1f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b67fbc99f6e747df8b6ad159ac99661b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"498fdfab08484722ab08cdc4579d78fe":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2473ce91a553489c80d7fd44c6053bed":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5a4899d4de6b483bbcfad075590d58a2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"6878972bcecd47e897ca6c622aa10e3f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6c4f705e35df4e1d8eb45848822e2c6e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e258c263759d4e21b81e78dad3bd7b88":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_21e4755449b74b17bd6836ea1f0956be","IPY_MODEL_c81c69a684834b38800ffdd3d72eb7ec","IPY_MODEL_dd4ebd54cfff446392893e5875c792f7"],"layout":"IPY_MODEL_05a4d5c9e58947c9a49e17071c58dbf2"}},"21e4755449b74b17bd6836ea1f0956be":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_15b9b9a8359b45eb8f04c7bb06c1668f","placeholder":"​","style":"IPY_MODEL_5a313f0826024a0cad2ef5bf85a254b1","value":"Batches: 100%"}},"c81c69a684834b38800ffdd3d72eb7ec":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_55f0be98145c41fd9250c80059662934","max":36,"min":0,"orientation":"horizontal","style":"IPY_MODEL_42d0699abbc14dc8ae6b0376e424b931","value":36}},"dd4ebd54cfff446392893e5875c792f7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_61e6921079f74704aed9fffab3587588","placeholder":"​","style":"IPY_MODEL_f2acc6fd5f0047308b2cb78e8f69783a","value":" 36/36 [00:44&lt;00:00,  2.21it/s]"}},"05a4d5c9e58947c9a49e17071c58dbf2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"15b9b9a8359b45eb8f04c7bb06c1668f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5a313f0826024a0cad2ef5bf85a254b1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"55f0be98145c41fd9250c80059662934":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"42d0699abbc14dc8ae6b0376e424b931":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"61e6921079f74704aed9fffab3587588":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f2acc6fd5f0047308b2cb78e8f69783a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"90cfc2507ba24edfbe6105ae47219bcf":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8aaef363800040698fbb87f1442691b3","IPY_MODEL_2ca2cb38d61744efa02938f1ec0a3b1b","IPY_MODEL_1405ea95275f48cda9c0d8f5c6022c17"],"layout":"IPY_MODEL_050c53ce886d4b88b1a9a206049b33c4"}},"8aaef363800040698fbb87f1442691b3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bd92e4c4ed204ae7b7725c05b42f562e","placeholder":"​","style":"IPY_MODEL_e665278188cc4a6da05acbd80698006d","value":"Batches: 100%"}},"2ca2cb38d61744efa02938f1ec0a3b1b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_9a594ec0c4bd47fe931b750770ad5674","max":148,"min":0,"orientation":"horizontal","style":"IPY_MODEL_fe84050aabe046e293d16c9c2b0c8b24","value":148}},"1405ea95275f48cda9c0d8f5c6022c17":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cc455ac009d64cddbf506ecdc2e5ef9a","placeholder":"​","style":"IPY_MODEL_9a90babf4d864b2084f7711d9fd46e95","value":" 148/148 [03:05&lt;00:00,  3.65it/s]"}},"050c53ce886d4b88b1a9a206049b33c4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bd92e4c4ed204ae7b7725c05b42f562e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e665278188cc4a6da05acbd80698006d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9a594ec0c4bd47fe931b750770ad5674":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fe84050aabe046e293d16c9c2b0c8b24":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"cc455ac009d64cddbf506ecdc2e5ef9a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9a90babf4d864b2084f7711d9fd46e95":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b5f90fcb034f48c5a0df078c7b34749d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_79e2d57e46d44d0e8ac1df73dbcb3bcd","IPY_MODEL_0aec98e0b1734a498f9ca9c322387119","IPY_MODEL_3472de4d0afd47168c760032d279a23b"],"layout":"IPY_MODEL_07731753cd3e40eabb9e52fb8d36b6dc"}},"79e2d57e46d44d0e8ac1df73dbcb3bcd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_68ce4f1abe3c453f934085d8f7c478f2","placeholder":"​","style":"IPY_MODEL_6c585a7feff440f7bfa7805a687d8e8c","value":"Batches: 100%"}},"0aec98e0b1734a498f9ca9c322387119":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f8c0a55442ab48e1a6992c65d12aa78c","max":79,"min":0,"orientation":"horizontal","style":"IPY_MODEL_49257f9ca3184cc8ad99b179a78db1f6","value":79}},"3472de4d0afd47168c760032d279a23b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1239260fa01d4306a24002295f2c62bb","placeholder":"​","style":"IPY_MODEL_1e74c2ceeb8642c2a0d3820206712239","value":" 79/79 [01:49&lt;00:00,  2.84it/s]"}},"07731753cd3e40eabb9e52fb8d36b6dc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"68ce4f1abe3c453f934085d8f7c478f2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6c585a7feff440f7bfa7805a687d8e8c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f8c0a55442ab48e1a6992c65d12aa78c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"49257f9ca3184cc8ad99b179a78db1f6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"1239260fa01d4306a24002295f2c62bb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1e74c2ceeb8642c2a0d3820206712239":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","source":["# BERTopic Script\n","\n","This script was developped in order to compare the effectiveness of possible topic modelling approaches.\n","\n","This script performs generational topic modelling on the dataset of processed love song lyrics using BERTopic.\n","\n","The workflow includes:\n","- Text preprocessing (lemmatisation via SpaCy).\n","- Generational categorisation based on release year.\n","- Topic modelling using BERTopic with UMAP dimensionality reduction to extract meaningful topics.\n","- Evaluation of topic coherence using Gensim’s CoherenceModel (to assess interpretability).\n","\n","Although this BERTopic model was implemented successfully, its results were not analysed in depth, as LDA outperformed it in comparative evaluation. This code is included here for transparency and reproducibility."],"metadata":{"id":"V1irU-8D3n7U"}},{"cell_type":"code","source":["# Required packages\n","!pip install bertopic sentence-transformers umap-learn hdbscan spacy nltk\n","!python -m spacy download en_core_web_sm\n","!pip install memory_profiler\n","!pip install gensim\n","\n","# Connect your drive to access the dataset\n","# (make sure to upload the datset to your drive)\n","from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"id":"4lceeRaAfI5g"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# --- Imports ---\n","import pandas as pd\n","import numpy as np\n","import random\n","import spacy\n","import nltk\n","from tqdm import tqdm\n","from bertopic import BERTopic\n","from umap import UMAP\n","from gensim.corpora import Dictionary\n","from gensim.models.coherencemodel import CoherenceModel\n","import warnings\n","\n","warnings.filterwarnings(\"ignore\")\n","\n","# --- Step 1: Setup ---\n","\n","# Set random seed for reproducibility\n","SEED = 42\n","np.random.seed(SEED)\n","random.seed(SEED)\n","\n","# Load SpaCy model\n","import spacy\n","nlp = spacy.load(\"en_core_web_sm\", disable=[\"parser\", \"ner\"])\n","\n","# Lemmatisation function\n","# Lemmatises the list of tokenised songs, keeping specified POS tags.\n","def lemmatise(tokens_list):\n","    results = []\n","    allowed_postags = ['NOUN', 'ADJ', 'VERB', 'ADV']\n","    for tokens in tqdm(tokens_list, desc=\"Lemmatising documents\"):\n","        if not isinstance(tokens, list) or not all(isinstance(word, str) for word in tokens):\n","            results.append([])\n","            continue\n","        doc = nlp(\" \".join(tokens))\n","        results.append([token.lemma_ for token in doc if token.pos_ in allowed_postags])\n","    return results\n","\n","# This function assigns generational tags\n","def assign_generation(year):\n","    try:\n","        year = int(float(year))  # handles strings or floats like \"1998.0\"\n","        if 1965 <= year <= 1980:\n","            return \"Gen X\"\n","        elif 1981 <= year <= 2000:\n","            return \"Millennial\"\n","        elif 2001 <= year <= 2010:\n","            return \"Gen Z\"\n","        elif year >= 2011:\n","            return \"Gen Alpha\"\n","        else:\n","            return \"Other\"\n","    except:\n","        return \"Unknown\"\n","\n","\n","# --- Step 2: Main Pipeline ---\n","FILE_PATH = \"/content/drive/MyDrive/processed_love_song_dataset_FINAL.csv\"\n","\n","try:\n","    df = pd.read_csv(FILE_PATH)\n","    print(f\"Loaded dataset from: {FILE_PATH}\")\n","except Exception as e:\n","    raise FileNotFoundError(f\"Failed to load file: {e}\")\n","\n","# Validate Required Columns\n","required_cols = ['Processed_Tokens', 'Release Year']\n","if not all(col in df.columns for col in required_cols):\n","    raise ValueError(\"Missing required columns in dataset.\")\n","\n","# Apply Generation Labels\n","df['Generation'] = df['Release Year'].apply(assign_generation)\n","\n","# Convert Processed_Tokens (string) to lists ---\n","import ast\n","\n","def safe_literal_eval(val):\n","    try:\n","        return ast.literal_eval(val) if isinstance(val, str) else []\n","    except (ValueError, SyntaxError):\n","        return []\n","\n","df['Preprocessed_Lyrics'] = df['Processed_Tokens'].apply(safe_literal_eval)\n","\n","# --- Lemmatise ---\n","df['Lemmatised'] = lemmatise(df['Preprocessed_Lyrics'])\n","df = df[df['Lemmatised'].str.len() > 0].copy()\n","\n","# Setup BERTopic\n","umap_model = UMAP(n_neighbors=10, n_components=3, metric='cosine', low_memory=True, random_state=SEED)\n","\n","topic_model = BERTopic(\n","    umap_model=umap_model,\n","    calculate_probabilities=False,\n","    verbose=True\n",")\n","\n","# --- Step 3: Run BERTopic by Generation ---\n","generations = df['Generation'].unique()\n","\n","for gen in sorted(generations):\n","    if gen in ['Other', 'Unknown']:\n","        print(f\"\\n⏭ Skipping Generation: {gen}\")\n","        continue\n","\n","    print(f\"\\n--- Processing {gen} ---\")\n","    gen_df = df[df['Generation'] == gen].copy()\n","    docs = [\" \".join(tokens) for tokens in gen_df['Lemmatised'].tolist()]\n","\n","    if not docs:\n","        print(f\"No documents to process for {gen}. Skipping.\")\n","        continue\n","\n","    try:\n","        topics, probs = topic_model.fit_transform(docs)\n","        print(f\"BERTopic model trained for {gen}\")\n","\n","        # Topic Summary\n","        topic_info = topic_model.get_topic_info()\n","        valid_topics = topic_info[topic_info['Topic'] != -1]\n","        print(f\"Topics found: {len(valid_topics)}\")\n","        print(valid_topics[['Topic', 'Count', 'Name']].head(5))\n","\n","        # Coherence Calculation\n","        topic_ids = valid_topics['Topic'].tolist()\n","        topic_words = [ [word for word, _ in topic_model.get_topic(tid)] for tid in topic_ids ]\n","        tokenized_docs = gen_df['Lemmatised'].tolist()\n","        dictionary = Dictionary(tokenized_docs)\n","\n","        if topic_words and tokenized_docs:\n","            coherence_model = CoherenceModel(\n","                topics=topic_words,\n","                texts=tokenized_docs,\n","                dictionary=dictionary,\n","                coherence='c_v'\n","            )\n","            coherence_score = coherence_model.get_coherence()\n","            print(f\"Coherence Score (c_v) for {gen}: {coherence_score:.4f}\")\n","        else:\n","            print(f\"Not enough data for coherence score for {gen}.\")\n","\n","    except Exception as e:\n","        print(f\"Error processing {gen}: {e}\")\n","        continue\n","\n","print(\"\\n All generations processed.\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["5b895c0b60b043d2b566b15ffff60791","af8928f5ca764bbd829df3aa292687af","0ed3901650eb4c138977cecd92d91def","dee67eddeb6442a5969e8ff3247cf451","ff04ebac5df74fd0a3ef7b1713643c1f","b67fbc99f6e747df8b6ad159ac99661b","498fdfab08484722ab08cdc4579d78fe","2473ce91a553489c80d7fd44c6053bed","5a4899d4de6b483bbcfad075590d58a2","6878972bcecd47e897ca6c622aa10e3f","6c4f705e35df4e1d8eb45848822e2c6e","e258c263759d4e21b81e78dad3bd7b88","21e4755449b74b17bd6836ea1f0956be","c81c69a684834b38800ffdd3d72eb7ec","dd4ebd54cfff446392893e5875c792f7","05a4d5c9e58947c9a49e17071c58dbf2","15b9b9a8359b45eb8f04c7bb06c1668f","5a313f0826024a0cad2ef5bf85a254b1","55f0be98145c41fd9250c80059662934","42d0699abbc14dc8ae6b0376e424b931","61e6921079f74704aed9fffab3587588","f2acc6fd5f0047308b2cb78e8f69783a","90cfc2507ba24edfbe6105ae47219bcf","8aaef363800040698fbb87f1442691b3","2ca2cb38d61744efa02938f1ec0a3b1b","1405ea95275f48cda9c0d8f5c6022c17","050c53ce886d4b88b1a9a206049b33c4","bd92e4c4ed204ae7b7725c05b42f562e","e665278188cc4a6da05acbd80698006d","9a594ec0c4bd47fe931b750770ad5674","fe84050aabe046e293d16c9c2b0c8b24","cc455ac009d64cddbf506ecdc2e5ef9a","9a90babf4d864b2084f7711d9fd46e95","b5f90fcb034f48c5a0df078c7b34749d","79e2d57e46d44d0e8ac1df73dbcb3bcd","0aec98e0b1734a498f9ca9c322387119","3472de4d0afd47168c760032d279a23b","07731753cd3e40eabb9e52fb8d36b6dc","68ce4f1abe3c453f934085d8f7c478f2","6c585a7feff440f7bfa7805a687d8e8c","f8c0a55442ab48e1a6992c65d12aa78c","49257f9ca3184cc8ad99b179a78db1f6","1239260fa01d4306a24002295f2c62bb","1e74c2ceeb8642c2a0d3820206712239"]},"id":"MRYq6MWEOBnQ","executionInfo":{"status":"ok","timestamp":1754307923821,"user_tz":-120,"elapsed":590261,"user":{"displayName":"Madeline Milne","userId":"07436396901549497411"}},"outputId":"c634ac27-8201-43f9-cfe1-34bebdda4df7"},"execution_count":14,"outputs":[{"output_type":"stream","name":"stdout","text":["Loaded dataset from: /content/drive/MyDrive/processed_love_song_dataset_FINAL.csv\n"]},{"output_type":"stream","name":"stderr","text":["Lemmatising documents: 100%|██████████| 11578/11578 [01:23<00:00, 138.50it/s]\n","2025-08-04 11:36:59,277 - BERTopic - Embedding - Transforming documents to embeddings.\n"]},{"output_type":"stream","name":"stdout","text":["\n","--- Processing Gen Alpha ---\n"]},{"output_type":"display_data","data":{"text/plain":["Batches:   0%|          | 0/90 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"5b895c0b60b043d2b566b15ffff60791"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["2025-08-04 11:39:00,527 - BERTopic - Embedding - Completed ✓\n","2025-08-04 11:39:00,528 - BERTopic - Dimensionality - Fitting the dimensionality reduction algorithm\n","2025-08-04 11:39:14,930 - BERTopic - Dimensionality - Completed ✓\n","2025-08-04 11:39:14,935 - BERTopic - Cluster - Start clustering the reduced embeddings\n","2025-08-04 11:39:15,061 - BERTopic - Cluster - Completed ✓\n","2025-08-04 11:39:15,066 - BERTopic - Representation - Fine-tuning topics using representation models.\n","2025-08-04 11:39:15,218 - BERTopic - Representation - Completed ✓\n"]},{"output_type":"stream","name":"stdout","text":["BERTopic model trained for Gen Alpha\n","Topics found: 2\n","   Topic  Count                             Name\n","1      0   2840             0_love_get_feel_need\n","2      1     13  1_wish_meet_wishinwishin_wishin\n"]},{"output_type":"stream","name":"stderr","text":["2025-08-04 11:39:15,646 - BERTopic - Embedding - Transforming documents to embeddings.\n"]},{"output_type":"stream","name":"stdout","text":["Coherence Score (c_v) for Gen Alpha: 0.3038\n","\n","--- Processing Gen X ---\n"]},{"output_type":"display_data","data":{"text/plain":["Batches:   0%|          | 0/36 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e258c263759d4e21b81e78dad3bd7b88"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["2025-08-04 11:39:59,970 - BERTopic - Embedding - Completed ✓\n","2025-08-04 11:39:59,973 - BERTopic - Dimensionality - Fitting the dimensionality reduction algorithm\n","2025-08-04 11:40:03,208 - BERTopic - Dimensionality - Completed ✓\n","2025-08-04 11:40:03,209 - BERTopic - Cluster - Start clustering the reduced embeddings\n","2025-08-04 11:40:03,252 - BERTopic - Cluster - Completed ✓\n","2025-08-04 11:40:03,256 - BERTopic - Representation - Fine-tuning topics using representation models.\n","2025-08-04 11:40:03,336 - BERTopic - Representation - Completed ✓\n"]},{"output_type":"stream","name":"stdout","text":["BERTopic model trained for Gen X\n","Topics found: 10\n","   Topic  Count                       Name\n","1      0    110      0_love_feel_life_need\n","2      1    104        1_get_ride_boy_girl\n","3      2     60     2_get_dark_chance_lose\n","4      3     44  3_dance_get_dancing_music\n","5      4     36   4_love_cruisin_mine_away\n"]},{"output_type":"stream","name":"stderr","text":["2025-08-04 11:40:03,677 - BERTopic - Embedding - Transforming documents to embeddings.\n"]},{"output_type":"stream","name":"stdout","text":["Coherence Score (c_v) for Gen X: 0.3425\n","\n","--- Processing Gen Z ---\n"]},{"output_type":"display_data","data":{"text/plain":["Batches:   0%|          | 0/148 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"90cfc2507ba24edfbe6105ae47219bcf"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["2025-08-04 11:43:08,902 - BERTopic - Embedding - Completed ✓\n","2025-08-04 11:43:08,903 - BERTopic - Dimensionality - Fitting the dimensionality reduction algorithm\n","2025-08-04 11:43:18,426 - BERTopic - Dimensionality - Completed ✓\n","2025-08-04 11:43:18,427 - BERTopic - Cluster - Start clustering the reduced embeddings\n","2025-08-04 11:43:18,631 - BERTopic - Cluster - Completed ✓\n","2025-08-04 11:43:18,637 - BERTopic - Representation - Fine-tuning topics using representation models.\n","2025-08-04 11:43:18,915 - BERTopic - Representation - Completed ✓\n"]},{"output_type":"stream","name":"stdout","text":["BERTopic model trained for Gen Z\n","Topics found: 39\n","   Topic  Count                              Name\n","1      0    256         0_tonight_alone_away_song\n","2      1    214               1_feel_keep_get_cry\n","3      2    178             2_bitch_get_fuck_shit\n","4      3     98              3_get_talk_girl_mind\n","5      4     98  4_suddenlycomplete_eye_gas_light\n"]},{"output_type":"stream","name":"stderr","text":["2025-08-04 11:43:20,891 - BERTopic - Embedding - Transforming documents to embeddings.\n"]},{"output_type":"stream","name":"stdout","text":["Coherence Score (c_v) for Gen Z: 0.3296\n","\n","--- Processing Millennial ---\n"]},{"output_type":"display_data","data":{"text/plain":["Batches:   0%|          | 0/79 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b5f90fcb034f48c5a0df078c7b34749d"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["2025-08-04 11:45:10,767 - BERTopic - Embedding - Completed ✓\n","2025-08-04 11:45:10,769 - BERTopic - Dimensionality - Fitting the dimensionality reduction algorithm\n","2025-08-04 11:45:23,052 - BERTopic - Dimensionality - Completed ✓\n","2025-08-04 11:45:23,054 - BERTopic - Cluster - Start clustering the reduced embeddings\n","2025-08-04 11:45:23,152 - BERTopic - Cluster - Completed ✓\n","2025-08-04 11:45:23,157 - BERTopic - Representation - Fine-tuning topics using representation models.\n","2025-08-04 11:45:23,309 - BERTopic - Representation - Completed ✓\n"]},{"output_type":"stream","name":"stdout","text":["BERTopic model trained for Millennial\n","Topics found: 2\n","   Topic  Count                      Name\n","1      0   1942      0_get_love_feel_girl\n","2      1     41  1_dance_get_feel_tonight\n","Coherence Score (c_v) for Millennial: 0.4078\n","\n","⏭ Skipping Generation: Other\n","\n"," All generations processed.\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"_fyM4kzBjM0E"},"execution_count":null,"outputs":[]}]}